
# Table Master

**Table Master** – это веб-приложение на базе Laravel 12, позволяющее пользователям загружать Excel-файлы, выполнять их конвертацию в различные форматы (XLS, XLSX, CSV, ODS, HTML) и слияние(только XLS, XLSX). Приложение использует асинхронную обработку задач посредством очередей для выполнения конвертаций с использованием библиотек PhpSpreadsheet и OpenSpout.

## Функциональные возможности

### Загрузка файлов

-   Пользователь может загрузить Excel-файл (форматы XLS и XLSX) через веб-интерфейс
-   Загруженный файл сохраняется на локальном диске, а его метаданные – в базе данных MySql

### Конвертация файлов

Приложение поддерживает несколько вариантов конвертации:

-   XLSX → XLS
-   XLS → XLSX 
-   XLSX/XLS → ODS
-   XLSX/XLS → CSV  (одиночный файл либо ZIP-архив для нескольких листов)
-   XLSX/XLS → TSV  (одиночный файл либо ZIP-архив для нескольких листов)
-   XLSX/XLS → HTML (одиночный файл либо ZIP-архив для нескольких листов)

### Слияние файлов

-   Для файлов формата XLS и XLSX существует фозможность слияние листков в один файл с сохранением стилей и форматирования

Все конвертации выполняются асинхронно с помощью Laravel Job. После завершения конвертации обновляются статус и путь к результату в базе данных.

### Скачивание результатов

После успешной конвертации готовый файл автоматически скачивается в браузере.

### Проверка статуса

Реализована функция периодической проверки статуса конвертации (через AJAX), позволяющая уведомлять пользователя о состоянии задачи.

## Архитектура приложения

### Основные компоненты

**Контроллеры**

-   `FileController` – загрузка и управление файлами (CRUD-операции)
-   `ProcessFileController` – запуск различных задач конвертации (методы вроде `xlsToXlsx`, `excelToCsv` и т.д.)
-   `DownloadController` – скачивание файлов, проверка статуса конвертации

**Job (`ConvertionJob`)**

-   Асинхронное выполнение задач по конвертации файлов
-   В зависимости от типа конвертации вызывается соответствующий метод, обновляющий статус и путь результата в базе данных

**Модель `UserFile`**
Хранит информацию о загруженных файлах, включая:

-   `original_name` – оригинальное имя файла
-   `path` – путь к загруженному файлу
-   `output_path` – путь к файлу после конвертации
-   `status` – текущий статус конвертации (например, processing, completed)

**Очереди (Queues)**

-   Все задачи по конвертации отправляются в очередь Laravel
-   Позволяет обрабатывать задачи асинхронно и не блокировать выполнение HTTP-запросов

**Внешние библиотеки**

-   PhpSpreadsheet
-   OpenSpout

## Установка и настройка

### Требования

-   PHP 8.2+
-   Composer
-   Laravel 12
-   Установленный XAMMP
-   git

### Шаги установки

1. **Клонирование репозитория**
    ```bash
    git clone https://github.com/Dmitr15/table-master.git
    ```

3. **Установка зависимостей через Composer**
    ```bash
    composer install
    ```
4. **Выполните миграции для создания необходимых таблиц**
    ```bash
    php artisan migrate
    ```
5. **Настройка очереди, в отдельном терминале**
    ```bash
    php artisan queue:work
    ```

6. **Запустить клиентскую часть в отдельном терминале**
    ```bash
    npm run dev
    ```
7. **Запустить сервер в отдельном терминале**
    ```bash
    php artisan serve
    ```
